<!-- ============================================================================
     DOCUMENTATION CONTENT - Expandable Sections
     ============================================================================ -->

<!-- Section 1: What Is This System? -->
<div class="doc-section" id="doc-what-is">
  <h3>üìã What Is This System?</h3>
  <p>
    The <strong>Google Sheets Access Manager</strong> is a centralized control system that manages who can access your organization's Google Sheets and when. Think of it as a "checkout system" for spreadsheets - similar to how a library manages books, this system ensures only one person edits a spreadsheet at a time, preventing conflicts and maintaining data integrity.
  </p>
  
  <h4>üéØ Core Concept</h4>
  <div class="concept-box problem">
    <strong>The Problem:</strong> When multiple people have permanent access to shared spreadsheets, you risk version conflicts, accidental overwrites, and unclear accountability. You may also forget who has access to what, creating security vulnerabilities.
  </div>
  
  <div class="concept-box solution">
    <strong>The Solution:</strong> This system provides <strong>temporary, time-limited access</strong> that automatically expires every night at midnight. Users "check out" a spreadsheet when they need it, work on it, and "check in" when done by logging out. No more permanent sharing links or forgotten permissions.
  </div>
</div>

<!-- Section 2: For General Users -->
<div class="doc-section" id="doc-users">
  <h3>üë• For General Users</h3>
  
  <h4>Getting Started</h4>
  <ol class="doc-list">
    <li><strong>Register:</strong> Create an account with your Gmail address and a secure password</li>
    <li><strong>Wait for Approval:</strong> An administrator will review and approve your registration</li>
    <li><strong>Login:</strong> Once approved, log in to access the system</li>
  </ol>
  
  <h4>Requesting Spreadsheet Access</h4>
  <ol class="doc-list">
    <li>Navigate to the <strong>Users</strong> tab</li>
    <li>Select the spreadsheet you need from the dropdown menu</li>
    <li>Click <strong>"Request Access"</strong></li>
    <li>The system instantly grants you permission and opens the spreadsheet in a new tab</li>
    <li>Work on your spreadsheet with the access level assigned (Viewer or Editor)</li>
  </ol>
  
  <h4>Important Rules</h4>
  <ul class="doc-list rules">
    <li>‚úÖ <strong>Keep the Access Manager tab open</strong> while working on your spreadsheet</li>
    <li>‚úÖ <strong>Click "Logout" when finished</strong> to release the spreadsheet for others</li>
    <li>‚úÖ Only one person can edit a spreadsheet at a time (prevents conflicts)</li>
    <li>‚úÖ All permissions automatically expire at midnight for security</li>
    <li>‚ö†Ô∏è You can check out multiple spreadsheets, but this is <strong>discouraged</strong> to ensure fair access</li>
  </ul>
  
  <h4>Need Help?</h4>
  <p>
    Click the <strong>"Contact Admin"</strong> button to send a message directly to the administrator about access issues, questions, or requests for additional spreadsheets.
  </p>
</div>

<!-- Section 3: For Administrators -->
<div class="doc-section" id="doc-admins">
  <h3>üîß For Administrators</h3>
  
    <h4>Addmin - Security</h4>
  <ul class="doc-list">
    <li><strong>GMAIL Account that deploys wep app - is the web app SUPER ADMIN</li>
    <li><strong>Other Admin may be assigned/approved - BUT CANNOT ACCESS/MODIFY/RESTRICT SUPER ADMIN</li>
    <li><strong>Other Admin's CANNOT share spreadsheets from their account</li>
    <li><strong>No Users or Admin's given Viewer or Editor access to spreadsheets allowed to re-share spreadsheets</strong></li>
  </ul>

  <h4>User Management</h4>
  <ul class="doc-list">
    <li><strong>Approve/Reject Registrations:</strong> Review new user registrations and approve legitimate users</li>
    <li><strong>Manage User Accounts:</strong> Edit user details, set admin privileges, place holds on accounts</li>
    <li><strong>Assign Spreadsheets:</strong> Grant users access to individual spreadsheets or entire groups</li>
    <li><strong>Delete Users:</strong> Remove users from the system and revoke all their permissions</li>
  </ul>
  
  <h4>Spreadsheet Management</h4>
  <ul class="doc-list">
    <li><strong>Add Spreadsheets:</strong> Add new Google Sheets to the system with custom descriptions</li>
    <li><strong>Set Access Levels:</strong> Configure whether users get Viewer or Editor permissions</li>
    <li><strong>Organize by Groups:</strong> Assign spreadsheets to numbered groups (1-20) for easier bulk assignment</li>
    <li><strong>Manage Availability:</strong> Place admin holds to temporarily restrict access to specific sheets</li>
    <li><strong>Delete Spreadsheets:</strong> Remove spreadsheets from the system and revoke all permissions</li>
    <li><strong>Release Sheets:</strong> Manually release checked-out spreadsheets if users forget to logout</li>
  </ul>
  
  <h4>System Monitoring</h4>
  <ul class="doc-list">
    <li><strong>Storage Dashboard:</strong> Monitor Property Service storage usage and capacity estimates</li>
    <li><strong>Activity Log:</strong> Track all system events including logins, checkouts, and modifications</li>
    <li><strong>Real-time Status:</strong> See which spreadsheets are currently checked out and by whom</li>
    <li><strong>User Overview:</strong> View all registered users and their approval status</li>
  </ul>
  
  <h4>Emergency Controls</h4>
  <ul class="doc-list">
    <li><strong>Clear All Sessions:</strong> Instantly log out all users and release all spreadsheets in case of emergency</li>
    <li><strong>Data Backup:</strong> Export complete user and spreadsheet data as JSON files for backup or migration</li>
  </ul>
</div>

<!-- Section 4: Security Features -->
<div class="doc-section" id="doc-security">
  <h3>üîí Security Features</h3>
  
  <div class="security-feature">
    <h4>1. Password Security</h4>
    <ul class="doc-list">
      <li>All passwords are encrypted using <strong>SHA-256 hashing</strong> before storage</li>
      <li>Passwords are never stored in plain text</li>
      <li>No one, including administrators, can view your password</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>2. Time-Limited Access</h4>
    <ul class="doc-list">
      <li><strong>Automatic Midnight Cleanup:</strong> All permissions expire at midnight every day</li>
      <li>Eliminates the risk of forgotten or outdated share permissions</li>
      <li>Forces regular re-authentication for active users</li>
      <li>Prevents indefinite access from compromised accounts</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>3. Session Management</h4>
    <ul class="doc-list">
      <li>Each login creates a unique, temporary session token</li>
      <li>Sessions are tracked and can be invalidated instantly</li>
      <li>Automatic logout releases all checked-out spreadsheets</li>
      <li>Admins can force-logout all users in emergencies</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>4. Role-Based Access Control</h4>
    <ul class="doc-list">
      <li>Clear separation between regular users and administrators</li>
      <li>Admin functions are completely locked to non-admin accounts</li>
      <li>User type is verified server-side on every sensitive operation</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>5. Activity Logging</h4>
    <ul class="doc-list">
      <li>Complete audit trail of all system activities</li>
      <li>Track who accessed which spreadsheet and when</li>
      <li>Monitor login attempts, successful and failed</li>
      <li>Review all administrative actions (user approvals, deletions, modifications)</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>6. Controlled Spreadsheet Access</h4>
    <ul class="doc-list">
      <li>Only assigned users can access specific spreadsheets</li>
      <li>One editor at a time prevents simultaneous edit conflicts</li>
      <li>Admin can place holds to temporarily block access</li>
      <li>Permissions are granted only through the system (no external sharing)</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>7. Gmail-Only Registration</h4>
    <ul class="doc-list">
      <li>Restricts registration to verified Gmail accounts only</li>
      <li>Reduces spam and fake account creation</li>
      <li>Leverages Google's account security infrastructure</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>8. Data Protection</h4>
    <ul class="doc-list">
      <li><strong>JSON Backup System:</strong> Full data export capability for disaster recovery</li>
      <li>Backup includes all user accounts, spreadsheet assignments, and system configuration</li>
      <li>Easy restoration in case of data corruption or accidental deletion</li>
      <li>Secure admin-only access to backup functions</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>9. Centralized Control</h4>
    <ul class="doc-list">
      <li>Single point of management for all spreadsheet permissions</li>
      <li>Admins maintain complete oversight of all access</li>
      <li>No "shadow sharing" outside the system</li>
      <li>Instant revocation of all permissions when needed</li>
    </ul>
  </div>
  
  <div class="security-feature">
    <h4>10. Property Service Security</h4>
    <ul class="doc-list">
      <li>All data stored in Google Apps Script Property Service</li>
      <li>Benefits from Google's enterprise-grade security infrastructure</li>
      <li>Data never leaves Google's secure environment</li>
      <li>No external databases or third-party services required</li>
    </ul>
  </div>
  
  <div class="security-summary">
    <strong>Security Summary:</strong> This system transforms spreadsheet access from <strong>permanent and untracked</strong> to <strong>temporary and audited</strong>. Every access is logged, every permission expires automatically, and administrators maintain complete control.
  </div>
</div>

<!-- Section 5: Key Benefits -->
<div class="doc-section" id="doc-benefits">
  <h3>‚ö° Key Benefits</h3>
  
  <h4>For Your Organization</h4>
  <ul class="doc-list benefits">
    <li><strong>Prevent Data Conflicts:</strong> Only one editor per spreadsheet eliminates version control issues</li>
    <li><strong>Maintain Accountability:</strong> Always know who has accessed what and when</li>
    <li><strong>Reduce Security Risk:</strong> Automatic permission expiration prevents forgotten access</li>
    <li><strong>Simplify Management:</strong> Single dashboard to control all spreadsheet access</li>
    <li><strong>Ensure Compliance:</strong> Complete audit trail for regulatory requirements</li>
  </ul>
  
  <h4>For Users</h4>
  <ul class="doc-list benefits">
    <li><strong>Simple Access:</strong> Request spreadsheets with one click</li>
    <li><strong>No Permission Confusion:</strong> Clear status of what you can access</li>
    <li><strong>Automatic Cleanup:</strong> No need to remember to revoke your own access</li>
    <li><strong>Fair Sharing:</strong> System ensures spreadsheets are available when you need them</li>
  </ul>
  
  <h4>For Administrators</h4>
  <ul class="doc-list benefits">
    <li><strong>Complete Visibility:</strong> Real-time dashboard of all system activity</li>
    <li><strong>Bulk Management:</strong> Assign users to groups of spreadsheets at once</li>
    <li><strong>Emergency Controls:</strong> Instantly lock down the system if needed</li>
    <li><strong>Easy Onboarding:</strong> Quick registration approval process</li>
    <li><strong>Data Safety:</strong> Full backup capability for disaster recovery</li>
  </ul>
</div>

<!-- Section 6: Common Questions -->
<div class="doc-section" id="doc-faq">
  <h3>üí° Common Questions</h3>
  
  <div class="faq-item">
    <h4>Q: What happens if I forget to logout?</h4>
    <p>
      <strong>A:</strong> All permissions automatically expire at midnight, so the spreadsheet will be released then. However, please logout manually to free it up sooner for other users.
    </p>
  </div>
  
  <div class="faq-item">
    <h4>Q: Can I access spreadsheets outside this system?</h4>
    <p>
      <strong>A:</strong> No. Access is only granted through the Access Manager system to maintain security and tracking.
    </p>
  </div>
  
  <div class="faq-item">
    <h4>Q: What if two people need to edit the same spreadsheet?</h4>
    <p>
      <strong>A:</strong> Users must coordinate and take turns. The first person checks out the sheet, completes their work, logs out, then the second person can check it out.
    </p>
  </div>
  
  <div class="faq-item">
    <h4>Q: Can I see who else has access to a spreadsheet?</h4>
    <p>
      <strong>A:</strong> Users can see which spreadsheets are currently checked out in the "Currently In Use" list. Admins can see full assignment details.
    </p>
  </div>
  
  <div class="faq-item">
    <h4>Q: What happens to my data if the system fails?</h4>
    <p>
      <strong>A:</strong> Admins can restore from JSON backups. The actual spreadsheet files are never affected - only the access control is managed by this system.
    </p>
  </div>
</div>

<!-- Section 7: Best Practices -->
<div class="doc-section" id="doc-best-practices">
  <h3>üöÄ Best Practices</h3>
  
  <h4>For Users</h4>
  <ol class="doc-list">
    <li>Always logout when finished to free up spreadsheets for others</li>
    <li>Keep the Access Manager tab open while working</li>
    <li>Only check out spreadsheets you're actively using</li>
    <li>Contact admin if you encounter any access issues</li>
  </ol>
  
  <h4>For Administrators</h4>
  <ol class="doc-list">
    <li>Review and approve new user registrations promptly</li>
    <li>Use groups to organize related spreadsheets</li>
    <li>Run regular backups (weekly recommended)</li>
    <li>Monitor the activity log for unusual patterns</li>
    <li>Keep admin credentials secure and private</li>
    <li>Use emergency clear sessions only when truly necessary</li>
  </ol>
</div>

<!-- Section 8: Technical Specifications -->
<div class="doc-section" id="doc-technical">
  <h3>üìä Technical Specifications</h3>
  
  <ul class="doc-list technical">
    <li><strong>Platform:</strong> Google Apps Script (runs entirely within Google's infrastructure)</li>
    <li><strong>Storage:</strong> Google Property Service (512 KB capacity)</li>
    <li><strong>Capacity:</strong> Supports approximately 75-100 users and 100-150 spreadsheets</li>
    <li><strong>Authentication:</strong> SHA-256 password hashing</li>
    <li><strong>Access Control:</strong> Session token-based authentication</li>
    <li><strong>Automation:</strong> Daily midnight cleanup via time-driven trigger</li>
    <li><strong>Backup Format:</strong> JSON (human-readable, universally compatible)</li>
  </ul>
</div>
